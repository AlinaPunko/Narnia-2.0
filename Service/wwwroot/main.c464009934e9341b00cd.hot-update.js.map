{"version":3,"sources":["webpack:///./src/components/ProfilePage/ProfileSection/profileSection.jsx"],"names":["ProfileSection","props","setState","photo","e","name","target","value","email","birthdate","slice","address","phone","input","document","createElement","type","accept","onchange","filesSelected","files","length","fileToLoad","fileReader","FileReader","onload","fileLoadedEvent","result","readAsDataURL","click","preventDefault","validator","allValid","userData","state","serviceWrapper","callService","userService","updateUser","errorFieldRef","alert","history","push","showMessages","forceUpdate","messages","message","profileValidationConfig","fieldName","rule","SimpleReactValidator","React","createRef","getUser","localStorageHelper","getId","user","id","isLoading","preloader","addPhoto","deletePhoto","onNameChange","onBirthdateChange","onAddressChange","onPhoneChange","getValidationResult","save","close","PureComponent","PropTypes","shape","number","isRequired","action","string","location","pathname","search","hash","key","func","withRouter"],"mappings":"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","file":"main.c464009934e9341b00cd.hot-update.js","sourcesContent":["import React from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport SimpleReactValidator from 'simple-react-validator';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport profileValidationConfig from 'validationConfigs/profileValidationConfig';\r\nimport userService from 'services/userService';\r\nimport serviceWrapper from 'helpers/serviceWrapper';\r\nimport localStorageHelper from 'helpers/localStorageHelper';\r\n\r\nimport './profileSection.scss';\r\n\r\nclass ProfileSection extends React.PureComponent {\r\n    static propTypes = {\r\n        history: PropTypes.shape({\r\n            length: PropTypes.number.isRequired,\r\n            action: PropTypes.string.isRequired,\r\n            location: PropTypes.shape({\r\n                pathname: PropTypes.string.isRequired,\r\n                search: PropTypes.string.isRequired,\r\n                hash: PropTypes.string.isRequired,\r\n                key: PropTypes.string.isRequired\r\n            }),\r\n            push: PropTypes.func.isRequired\r\n        }).isRequired\r\n    }\r\n\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.validator = new SimpleReactValidator();\r\n        this.errorFieldRef = React.createRef();\r\n        this.state = {\r\n            photo: '',\r\n            name: '',\r\n            email: '',\r\n            birthdate: '',\r\n            address: '',\r\n            phone: ''\r\n        };\r\n    }\r\n\r\n    async componentDidMount() {\r\n        const user = await userService.getUser(localStorageHelper.getId());\r\n        this.setState({\r\n            id: user.id,\r\n            name: user.name,\r\n            address: user.address,\r\n            phone: user.phone,\r\n            email: user.email,\r\n            photo: user.photo,\r\n            birthdate: user.birthdate ? user.birthdate.slice(0, 10) : ''\r\n        });\r\n    }\r\n\r\n    deletePhoto = () => {\r\n        this.setState({ photo: '' });\r\n    }\r\n\r\n    onNameChange = (e) => {\r\n        this.setState({ name: e.target.value });\r\n    }\r\n\r\n    onEmailChange = (e) => {\r\n        this.setState({ email: e.target.value });\r\n    }\r\n\r\n    onBirthdateChange = (e) => {\r\n        this.setState({ birthdate: e.target.value.slice(0, 10) });\r\n    }\r\n\r\n    onAddressChange = (e) => {\r\n        this.setState({ address: e.target.value });\r\n    }\r\n\r\n    onPhoneChange = (e) => {\r\n        this.setState({ phone: e.target.value });\r\n    }\r\n\r\n    addPhoto = () => {\r\n        const input = document.createElement('input');\r\n        input.type = 'file';\r\n        input.accept = 'image/x-png,image/gif,image/jpeg';\r\n        input.onchange = () => {\r\n            const filesSelected = input.files;\r\n\r\n            if (filesSelected.length > 0) {\r\n                const fileToLoad = filesSelected[0];\r\n                const fileReader = new FileReader();\r\n                fileReader.onload = (fileLoadedEvent) => {\r\n                    this.setState({ photo: fileLoadedEvent.target.result });\r\n                };\r\n                fileReader.readAsDataURL(fileToLoad);\r\n            }\r\n        };\r\n        input.click();\r\n    }\r\n\r\n    save = async (e) => {\r\n        e.preventDefault();\r\n        if (this.validator.allValid()) {\r\n            const userData = { ...this.state };\r\n            await serviceWrapper.callService(userService.updateUser, userData, this.errorFieldRef);\r\n            alert('The user was updated');\r\n            this.props.history.push('/');\r\n        } else {\r\n            this.validator.showMessages();\r\n            this.forceUpdate();\r\n        }\r\n    }\r\n\r\n    close = (e) => {\r\n        e.preventDefault();\r\n        this.props.history.push('/');\r\n    }\r\n\r\n    getValidationResult = () => {\r\n        const messages = [\r\n            this.validator.message(profileValidationConfig.email.fieldName, this.state.email, profileValidationConfig.email.rule),\r\n            this.validator.message(profileValidationConfig.name.fieldName, this.state.name, profileValidationConfig.name.rule),\r\n            this.validator.message(profileValidationConfig.phone.fieldName, this.state.phone, profileValidationConfig.phone.rule),\r\n            this.validator.message(profileValidationConfig.address.fieldName, this.state.address, profileValidationConfig.address.rule)\r\n        ];\r\n\r\n        return (\r\n            <div className=\"profile-section__validation-result\" ref={this.errorFieldRef}>\r\n                {messages}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    render() {\r\n        if (localStorageHelper.getId() === '' || localStorageHelper.getId() === null) {\r\n            this.props.history.push('/login');\r\n            return null;\r\n        }\r\n\r\n        if(this.state.isLoading){\r\n            {this.state.isLoading && (\r\n                <div className=\"books-list__preloader\">\r\n                    <Icon iconClassName=\"books-list__preloader-icon\" icon={preloader} />\r\n                </div>\r\n            )}\r\n        }\r\n\r\n        return (\r\n            <section className=\"profile-section\">\r\n                <h1 className=\"profile-section__title\">Your profile</h1>\r\n                <form className=\"profile-section__form\">\r\n                    <div className=\"profile-section__image-block\">\r\n                        <img\r\n                            className=\"profile-section__user-image\"\r\n                            alt=\"\"\r\n                            src={this.state.photo}\r\n                        />\r\n                        <div>\r\n                            <button className=\"profile-section__add-image-button\" type=\"button\" onClick={this.addPhoto}>\r\n                                Add image\r\n                            </button>\r\n                            <button className=\"profile-section__delete-image-button\" type=\"button\" onClick={this.deletePhoto}>\r\n                                Delete image\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"profile-section__user-info\">\r\n                        <div className=\"profile-section__field\">\r\n                            <label className=\"profile-section__field-title\">Name</label>\r\n                            <input\r\n                                name=\"name\"\r\n                                type=\"text\"\r\n                                value={this.state.name}\r\n                                className=\"profile-section__field-input\"\r\n                                onChange={this.onNameChange}\r\n                                disabled\r\n                            />\r\n                        </div>\r\n                        <div className=\"profile-section__field\">\r\n                            <label className=\"profile-section__field-title\">E-mail</label>\r\n                            <input\r\n                                name=\"email\"\r\n                                type=\"email\"\r\n                                value={this.state.email}\r\n                                className=\"profile-section__field-input\"\r\n                                disabled\r\n                            />\r\n                        </div>\r\n                        <div className=\"profile-section__field\">\r\n                            <label className=\"profile-section__field-title\">Birthdate</label>\r\n                            <input\r\n                                name=\"birthdate\"\r\n                                type=\"date\"\r\n                                value={this.state.birthdate}\r\n                                className=\"profile-section__field-input\"\r\n                                onChange={this.onBirthdateChange}\r\n                            />\r\n                        </div>\r\n                        <div className=\"profile-section__field\">\r\n                            <label className=\"profile-section__field-title\">Address</label>\r\n                            <input\r\n                                name=\"address\"\r\n                                type=\"text\"\r\n                                value={this.state.address}\r\n                                className=\"profile-section__field-input\"\r\n                                onChange={this.onAddressChange}\r\n                            />\r\n                        </div>\r\n                        <div className=\"profile-section__field\">\r\n                            <label className=\"profile-section__field-title\">Phone</label>\r\n                            <input\r\n                                name=\"phone\"\r\n                                type=\"tel\"\r\n                                pattern=\"375[0-9]{2}[0-9]{7}\"\r\n                                value={this.state.phone}\r\n                                className=\"profile-section__field-input\"\r\n                                onChange={this.onPhoneChange}\r\n                            />\r\n                        </div>\r\n                        {\r\n                            this.getValidationResult()\r\n                        }\r\n                        <input type=\"submit\" className=\"profile-section__save-button\" onClick={this.save} value=\"Save\" />\r\n                        <input type=\"reset\" className=\"profile-section__close-button\" onClick={this.close} value=\"Close\" />\r\n                    </div>\r\n                </form>\r\n            </section>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(ProfileSection);\r\n"],"sourceRoot":""}