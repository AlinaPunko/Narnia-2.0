{"version":3,"sources":["webpack:///./src/components/orderPage/BooksSection/booksSection.jsx"],"names":["BooksSection","props","localStorageHelper","getUserItems","getId","books","result","element","bookService","getById","bookId","bookInfo","amount","setState","sum","parseFloat","state","price","toFixed","push","isLoading","components","forEach","authors","author","genres","genre","title","join","pagesCount","publishingYear","id","image","order","userId","orderService","add","alert","deleteUsersCart","history","renderBooks","preloader","saveOrder","React","Component","PropTypes","shape","length","number","isRequired","action","string","location","pathname","search","hash","key","func"],"mappings":"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","file":"main.2ac7cc79475cfb4f2cdb.hot-update.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n\r\nimport OpenDetailsPageButton from 'components/common/OpenDetailsPageButton/openDetailsPageButton';\r\nimport FavoriteButton from 'components/common/FavoriteButton/favoriteButton';\r\nimport localStorageHelper from 'helpers/localStorageHelper';\r\nimport bookService from 'services/bookService';\r\nimport orderService from 'services/orderService';\r\nimport Icon from 'components/common/Icon/icon';\r\n\r\nimport preloader from 'styles/icons/preloader.svg';\r\nimport './booksSection.scss';\r\n\r\nexport default class BooksSection extends React.Component {\r\n    static propTypes = {\r\n        history: PropTypes.shape({\r\n            length: PropTypes.number.isRequired,\r\n            action: PropTypes.string.isRequired,\r\n            location: PropTypes.shape({\r\n                pathname: PropTypes.string.isRequired,\r\n                search: PropTypes.string.isRequired,\r\n                hash: PropTypes.string.isRequired,\r\n                key: PropTypes.string.isRequired\r\n            }),\r\n            push: PropTypes.func.isRequired\r\n        }).isRequired\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            books: [],\r\n            sum: 0,\r\n            isLoading: true\r\n        };\r\n    }\r\n\r\n\r\n    componentDidMount = async () => {\r\n        const { books } = localStorageHelper.getUserItems(localStorageHelper.getId());\r\n        const result = [];\r\n\r\n        for (const element of books) {\r\n            const bookInfo = await bookService.getById(element.bookId);\r\n            bookInfo.amount = element.amount;\r\n\r\n            this.setState({\r\n                sum: parseFloat((this.state.sum + bookInfo.price * bookInfo.amount).toFixed(2))\r\n            });\r\n            result.push(bookInfo);\r\n        }\r\n\r\n        this.setState({\r\n            books: result,\r\n            isLoading: false\r\n        });\r\n    }\r\n\r\n    renderBooks = () => {\r\n        const components = [];\r\n        const { books } = this.state;\r\n\r\n        books.forEach((element) => {\r\n            const authors = [];\r\n            element.authors.forEach((author) => {\r\n                authors.push(author);\r\n            });\r\n\r\n            const genres = [];\r\n            element.genres.forEach((genre) => {\r\n                genres.push(genre);\r\n            });\r\n\r\n            components.push(\r\n                <div className=\"books-section-list-item\">\r\n                    <div>\r\n                        <div className=\"books-section-list-item__title\">{element.title}</div>\r\n                        <div className=\"books-section-list-item__authors\">Authors: {authors.join(', ')}</div>\r\n                        <div className=\"books-section-list-item__genres\">Genres: {genres.join(', ')}</div>\r\n                        <div className=\"books-section-list-item__pages\">Pages: {element.pagesCount}</div>\r\n                        <div className=\"books-section-list-item__publishing-year\">Publishing year: {element.publishingYear}</div>\r\n                        <div className=\"books-section-list-item__price\">Price: {element.price}</div>\r\n                        <div className=\"books-section-list-item__amount\">Amount: {element.amount}</div>\r\n                        <div className=\"books-section-list-item__buttons\">\r\n                            <OpenDetailsPageButton bookId={element.id} className=\"books-section-list-item__details-button\" />\r\n                            <FavoriteButton book={element} className=\"books-section-list-item__favorite-button\" />\r\n                        </div>\r\n                    </div>\r\n                    <img alt=\"Item_image\" className=\"books-section-list-item__image\" src={element.image} />\r\n                </div>\r\n            );\r\n        });\r\n\r\n        return components;\r\n    }\r\n\r\n    saveOrder = async () => {\r\n        const order = this.state;\r\n        order.userId = localStorageHelper.getId();\r\n        await orderService.add(order);\r\n        alert('We received your order, the manager will call you as soon as possible');\r\n        localStorageHelper.deleteUsersCart(localStorageHelper.getId());\r\n        this.props.history.push('/');\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"books-section\">\r\n                {this.renderBooks()}\r\n                {\r\n                    this.state.isLoading && (\r\n                        <div className=\"books-section__preloader\">\r\n                            <Icon iconClassName=\"books-section__preloader-icon\" icon={preloader} />\r\n                        </div>\r\n                    )\r\n                }\r\n                <h2 className=\"books-section__total-price\">Total price: {this.state.sum}</h2>\r\n                <button className=\"books-section__save-button\" type=\"button\" onClick={this.saveOrder}>Pay for order</button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n"],"sourceRoot":""}