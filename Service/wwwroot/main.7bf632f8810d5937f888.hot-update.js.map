{"version":3,"sources":["webpack:///./src/components/orderPage/BooksSection/booksSection.jsx"],"names":["BooksSection","props","localStorageHelper","getUserItems","getId","books","result","element","bookService","getById","bookId","bookInfo","amount","setState","totalPrice","state","sum","price","push","components","forEach","authors","author","genres","genre","title","join","pagesCount","publishingYear","id","image","order","userId","orderService","add","alert","deleteUsersCart","history","renderBooks","saveOrder","React","Component","PropTypes","shape","length","number","isRequired","action","string","location","pathname","search","hash","key","func"],"mappings":"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","file":"main.7bf632f8810d5937f888.hot-update.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n\r\nimport OpenDetailsPageButton from 'components/common/OpenDetailsPageButton/openDetailsPageButton';\r\nimport FavoriteButton from 'components/common/FavoriteButton/favoriteButton';\r\nimport localStorageHelper from 'helpers/localStorageHelper';\r\nimport bookService from 'services/bookService';\r\nimport orderService from 'services/orderService';\r\n\r\nimport './booksSection.scss';\r\n\r\nexport default class BooksSection extends React.Component {\r\n    static propTypes = {\r\n        history: PropTypes.shape({\r\n            length: PropTypes.number.isRequired,\r\n            action: PropTypes.string.isRequired,\r\n            location: PropTypes.shape({\r\n                pathname: PropTypes.string.isRequired,\r\n                search: PropTypes.string.isRequired,\r\n                hash: PropTypes.string.isRequired,\r\n                key: PropTypes.string.isRequired\r\n            }),\r\n            push: PropTypes.func.isRequired\r\n        }).isRequired\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            books: [],\r\n            sum: 0\r\n        };\r\n    }\r\n\r\n\r\n    componentDidMount = async () => {\r\n        const { books } = localStorageHelper.getUserItems(localStorageHelper.getId());\r\n        const result = [];\r\n\r\n        for (const element of books) {\r\n            const bookInfo = await bookService.getById(element.bookId);\r\n            bookInfo.amount = element.amount;\r\n\r\n            this.setState({\r\n                totalPrice: this.state.sum + bookInfo.price * bookInfo.amount\r\n            });\r\n            result.push(bookInfo);\r\n        }\r\n\r\n        this.setState({ books: result });\r\n    }\r\n\r\n    renderBooks = () => {\r\n        const components = [];\r\n        const { books } = this.state;\r\n\r\n        books.forEach((element) => {\r\n            const authors = [];\r\n            element.authors.forEach((author) => {\r\n                authors.push(author);\r\n            });\r\n\r\n            const genres = [];\r\n            element.genres.forEach((genre) => {\r\n                genres.push(genre);\r\n            });\r\n\r\n            components.push(\r\n                <div className=\"books-section-list-item\">\r\n                    <div>\r\n                        <div className=\"books-section-list-item__title\">{element.title}</div>\r\n                        <div className=\"books-section-list-item__authors\">Authors: {authors.join(', ')}</div>\r\n                        <div className=\"books-section-list-item__genres\">Genres: {genres.join(', ')}</div>\r\n                        <div className=\"books-section-list-item__pages\">Pages: {element.pagesCount}</div>\r\n                        <div className=\"books-section-list-item__publishing-year\">Publishing year: {element.publishingYear}</div>\r\n                        <div className=\"books-section-list-item__price\">Price: {element.price}</div>\r\n                        <div className=\"books-section-list-item__amount\">Amount: {element.amount}</div>\r\n                        <div className=\"books-section-list-item__buttons\">\r\n                            <OpenDetailsPageButton bookId={element.id} className=\"books-section-list-item__details-button\" />\r\n                            <FavoriteButton book={element} className=\"books-section-list-item__favorite-button\" />\r\n                        </div>\r\n                    </div>\r\n                    <img alt=\"Item_image\" className=\"books-section-list-item__image\" src={element.image} />\r\n                </div>\r\n            );\r\n        });\r\n\r\n        return components;\r\n    }\r\n\r\n    saveOrder = async () => {\r\n        const order = this.state;\r\n        order.userId = localStorageHelper.getId();\r\n        const result = await orderService.add(order);\r\n        if (result) {\r\n            alert('We received your order, the manager will call you as soon as possible');\r\n            localStorageHelper.deleteUsersCart(localStorageHelper.getId());\r\n            this.props.history.push('/');\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"books-section\">\r\n                {this.renderBooks()}\r\n                <h2 className=\"books-section__total-price\">Total price: {this.state.totalPrice}</h2>\r\n                <button className=\"books-section__save-button\" type=\"button\" onClick={this.saveOrder}>Pay for order</button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n"],"sourceRoot":""}